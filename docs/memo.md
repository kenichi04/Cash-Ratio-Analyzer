## 開発用メモ
- EDINET 書類取得API用のテスト用docId: S100TGZR

## 「報告書インスタンス作成ガイドライン」より抜粋
- タグ情報について
　- 提出者別タクソノミの参照、ユニットの定義、コンテキストの定義、DEIの設定
    - 提出書類本文全体の場合、表紙ファイルに定義
    - 財務諸表本表のみの場合、本表の一つ目のファイルに定義
    - DEIの設定、提出者別タクソノミの参照、コンテキスト定義、ユニット定義は<ix:header>タグ内に指定
      - コンテキストの定義 > 報告する会計年度、報告主体などの定義
      - ユニットの定義 > 報告する通貨、株数等の単位を定義
- 財務諸表本表のみタグ付け対象とする場合、表紙のインラインXBRLファイルは作成しない
  - 以下でソースコードに落とし込みできそう
    - 表紙のインラインファイルあり > ここからタグ情報を取得
    - 表紙のインラインファイルなし > 本表の一つ目のファイルからタグ情報を取得
- 表紙ファイル名は、先頭の7桁数値と6文字が「0000000_header」と決まっている（0000000も固定らしい）ｘ
  - 先頭文字と、拡張子「_ixbrl.htl」で表紙ファイルを特定でそう
  - 本文の最初のファイルは「0101」は固定、多くは「0101010」になりそうだが断定はできない
    - 0101が複数あるかどうかでロジック組む？
- XBRLインスタンスファイル
  - インラインXBRLファイルをEDINET登録することで自動生成される
  - これを見れば必要な情報全部あるかも？ただし容量が大きい
- タクソノミの参照
  - スキーマファイルの参照 > schemaRef要素で指定
  - 拡張リンクロールの参照 > roleRef要素で指定
- 報告書インスタンスの作成
  - コンテキスト及びユニットの定義
  - DEIの内容を記載
  - 報告する値や内容の記載
- 報告項目の各値,内容
  - ix: で始まるタグ
    - ix:nonFraction > 金額または数値
    - ix:nonNumeric > 数値以外の文字列または文章
    - ix:header > ヘッダ情報
- DEIの設定（P71）
  - DEI > Document and Entity Information
    - 提出書類の基本情報（Document Information）
    - 開示書類等提出者の基本情報（Entity Information）
  - DEIはix:header要素の子要素「ix:hidden 要素」に定義（表示しない値と同じ方法）
  - DEIのコンテキストIDは「FilingDateInstant」を利用

## メモ
- Accountに登録する科目洗い出し
  - EDINETタクソノミの科目一覧ツリー確認
  - EDINETタクソノミ（語彙層）の語彙スキーマが基本か
  - 有価証券報告書ではEDINETタクソノミのうち以下が参照される？
    - 内閣府令タクソノミ、財務諸表本表タクソノミ、DEIタクソノミ
  - 提出者別タクソノミのスキーマファイル(.xsd)で参照先など確認できる
  　- スキーマファイル名で様式確認できる
  　- 各リンクファイル(xml)で名称や計算リンク
- 書類情報の確認方法
  - 様式ツリーで確認できそう
  - タクソノミ分割単位 > jpcrpで良さそう？
    - 財務諸表本表でjppfsもあるみたい
- EDINETタクソノミのフォルダ確認
  - jpcrp - {日付} - jpcrp_cor(rt)_{日付}.xsd > 語彙スキーマ, ロールタイプスキーマ


## TODO
- [x] XBRL解析サービスにタグ情報取得処理を追加
  - [x] 表紙のインラインXBRLファイル有無で処理を分岐
- [x] 通貨をユニット定義で取得
- ~~[x] 会計年度をコンテキストの定義から取得する~~
- [x] 会計年度はDEI情報から取得する
- [ ] DEI情報を使用して必要なヘッダ情報を生成する
- [ ] FinancialDataとAccountの関係見直し
- [ ] XbrlParserServiceのユニットテスト
- [ ] メタデータ取得時のレスポンスは企業情報も入れる？（documentIDのみは分かりにくい）
- [ ] Edinetのバリデーション変更
  - E + 数字5桁

